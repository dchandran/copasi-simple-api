<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Copasi API: Simplifed API for the COPASI Library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Copasi API</div>
   <div id="projectbrief">Simple C API to COPASI</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>Simplifed API for the COPASI Library </h1>  </div>
</div>
<div class="contents">
<div class="textblock"><h2><a class="anchor" id="intro_sec"></a>
Introduction</h2>
<p>The developers of COPASI provide COPASI as a reusable library as well as the well known COPASI user interface. The library however has a fairly complex API and can take some time getting used. We have therefore layered on top of the COPASI library a new C based API that we feel is much simpler to use. For example, to run a simple SBML model and generate time series data we would call:</p>
<div class="fragment"><pre class="fragment"> <a class="code" href="structcopasi__model.html" title="This struct is used to contain a pointer to an instance of a COPASI object.">copasi_model</a> m;
 <a class="code" href="structtc__matrix.html" title="A 2D table of doubles with row and column names. Use tc_getMatrixValue(M,i,j) to get the i...">tc_matrix</a> output;
  
 m = <a class="code" href="copasi__api_8h.html#abc7ff9a39c495829cf55f2a9ad0e3829" title="Create a model from an SBML file.">cReadSBMLFile</a> (<span class="stringliteral">&quot;mymodel.xml&quot;</span>);
  
 output = cSimulationDeterministic (m, 0, 10, 100); 

 <a class="code" href="_t_c__structs_8h.html#afd5e48e35113e4e575e6fd08da441ddf" title="Print a matrix to file.">tc_printMatrixToFile</a>(<span class="stringliteral">&quot;output.tab&quot;</span>, output);  <span class="comment">//write to file</span>

 <span class="comment">//cleanup</span>
 <a class="code" href="_t_c__structs_8h.html#a4ced7d8d8f300f44d5deeb78d88a1c23" title="Delete a matrix.">tc_deleteMatrix</a>(output);                 
 <a class="code" href="copasi__api_8h.html#abc2d742f859eb00c34198942b22aa44c" title="remove a model">cRemoveModel</a>(m1);
 <a class="code" href="copasi__api_8h.html#afb781ad02eaef984e47c868071ebd968" title="destroy copasi -- MUST BE CALLED at the end of program">copasi_end</a>();  <span class="comment">//required at the very end</span>
</pre></div><p>More complex example:</p>
<div class="fragment"><pre class="fragment"><span class="preprocessor"> #include &lt;stdlib.h&gt;</span>
<span class="preprocessor"> #include &lt;stdio.h&gt;</span>
<span class="preprocessor"> #include &quot;<a class="code" href="copasi__api_8h.html" title="Simple C API for the Copasi C++ library.">copasi_api.h</a>&quot;</span>

 <a class="code" href="structcopasi__model.html" title="This struct is used to contain a pointer to an instance of a COPASI object.">copasi_model</a> model1() <span class="comment">//create oscillator model</span>
 {
        <span class="comment">//model named M</span>
        <a class="code" href="structcopasi__model.html" title="This struct is used to contain a pointer to an instance of a COPASI object.">copasi_model</a> model = <a class="code" href="copasi__api_8h.html#ae797f3bdea43852219b02deb7c3a83f3" title="Create a model.">cCreateModel</a>(<span class="stringliteral">&quot;M&quot;</span>);
        <a class="code" href="structcopasi__reaction.html" title="This struct is used to contain a pointer to an instance of a COPASI reaction object.">copasi_reaction</a> R1, R2, R3;
        <a class="code" href="structcopasi__compartment.html" title="This struct is used to contain a pointer to an instance of a COPASI compartment object.">copasi_compartment</a> cell;
        
        <span class="comment">//species</span>
        cell = <a class="code" href="copasi__api_8h.html#a2256ee7e63c6d4481aa88de4a7197744" title="Create compartment.">cCreateCompartment</a>(model, <span class="stringliteral">&quot;cell&quot;</span>, 1.0);
        <a class="code" href="copasi__api_8h.html#aa32ab75587401cfc24428e86a0d215b5" title="Add a species to the model.">cCreateSpecies</a>(cell, <span class="stringliteral">&quot;A&quot;</span>, 4);
        <a class="code" href="copasi__api_8h.html#aa32ab75587401cfc24428e86a0d215b5" title="Add a species to the model.">cCreateSpecies</a>(cell, <span class="stringliteral">&quot;B&quot;</span>, 3);
        <a class="code" href="copasi__api_8h.html#aa32ab75587401cfc24428e86a0d215b5" title="Add a species to the model.">cCreateSpecies</a>(cell, <span class="stringliteral">&quot;C&quot;</span>, 2);
        
        <span class="comment">//parameters</span>
        <a class="code" href="copasi__api_8h.html#ad0116984e87902a9b608a08717570a20" title="Set the concentration of a species, volume of a compartment, or value of a parameter The function wil...">cSetValue</a>(model, <span class="stringliteral">&quot;k1&quot;</span>, 0.2);   <span class="comment">//k1</span>
        <a class="code" href="copasi__api_8h.html#ad0116984e87902a9b608a08717570a20" title="Set the concentration of a species, volume of a compartment, or value of a parameter The function wil...">cSetValue</a>(model, <span class="stringliteral">&quot;k2&quot;</span>, 0.5);   <span class="comment">//k2</span>
        <a class="code" href="copasi__api_8h.html#ad0116984e87902a9b608a08717570a20" title="Set the concentration of a species, volume of a compartment, or value of a parameter The function wil...">cSetValue</a>(model, <span class="stringliteral">&quot;k3&quot;</span>, 1);   <span class="comment">//k3</span>
        
        <span class="comment">//reactions -- make sure all parameters or species are defined BEFORE this step</span>
        R1 = <a class="code" href="copasi__api_8h.html#a7e704796eebcdb6e138ff7bfa64ff1a4" title="Create a new reaction with a given name.">cCreateReaction</a>(model, <span class="stringliteral">&quot;R1&quot;</span>);  <span class="comment">// A+B -&gt; 2B</span>
        <a class="code" href="copasi__api_8h.html#aea1d98a0d70811e2e1387363414b27d8" title="Add a reactant to a reaction.">cAddReactant</a>(R1, <span class="stringliteral">&quot;A&quot;</span>, 1.0);
        <a class="code" href="copasi__api_8h.html#aea1d98a0d70811e2e1387363414b27d8" title="Add a reactant to a reaction.">cAddReactant</a>(R1, <span class="stringliteral">&quot;B&quot;</span>, 1.0);
        <a class="code" href="copasi__api_8h.html#ab24bea25b0e39d1c76a060c3b51436e6" title="Add a product to a reaction.">cAddProduct</a>(R1, <span class="stringliteral">&quot;B&quot;</span>, 2.0);
        <a class="code" href="copasi__api_8h.html#a01316099febb0ab0223aabae0a16d85b" title="Set reaction rate equation.">cSetReactionRate</a>(R1, <span class="stringliteral">&quot;k1*A*B&quot;</span>);

        R2 = <a class="code" href="copasi__api_8h.html#a7e704796eebcdb6e138ff7bfa64ff1a4" title="Create a new reaction with a given name.">cCreateReaction</a>(model, <span class="stringliteral">&quot;R2&quot;</span>);  <span class="comment">//B+C -&gt; 2C</span>
        <a class="code" href="copasi__api_8h.html#aea1d98a0d70811e2e1387363414b27d8" title="Add a reactant to a reaction.">cAddReactant</a>(R2, <span class="stringliteral">&quot;B&quot;</span>, 1.0);
        <a class="code" href="copasi__api_8h.html#aea1d98a0d70811e2e1387363414b27d8" title="Add a reactant to a reaction.">cAddReactant</a>(R2, <span class="stringliteral">&quot;C&quot;</span>, 1.0);
        <a class="code" href="copasi__api_8h.html#ab24bea25b0e39d1c76a060c3b51436e6" title="Add a product to a reaction.">cAddProduct</a>(R2, <span class="stringliteral">&quot;C&quot;</span>, 2.0);
        <a class="code" href="copasi__api_8h.html#a01316099febb0ab0223aabae0a16d85b" title="Set reaction rate equation.">cSetReactionRate</a>(R2, <span class="stringliteral">&quot;k2*B*C&quot;</span>);

        R3 = <a class="code" href="copasi__api_8h.html#a7e704796eebcdb6e138ff7bfa64ff1a4" title="Create a new reaction with a given name.">cCreateReaction</a>(model, <span class="stringliteral">&quot;R3&quot;</span>); <span class="comment">//C+A -&gt; 2A</span>
        <a class="code" href="copasi__api_8h.html#aea1d98a0d70811e2e1387363414b27d8" title="Add a reactant to a reaction.">cAddReactant</a>(R3, <span class="stringliteral">&quot;C&quot;</span>, 1.0);
        <a class="code" href="copasi__api_8h.html#aea1d98a0d70811e2e1387363414b27d8" title="Add a reactant to a reaction.">cAddReactant</a>(R3, <span class="stringliteral">&quot;A&quot;</span>, 1.0);
        <a class="code" href="copasi__api_8h.html#ab24bea25b0e39d1c76a060c3b51436e6" title="Add a product to a reaction.">cAddProduct</a>(R3, <span class="stringliteral">&quot;A&quot;</span>, 2.0);
        <a class="code" href="copasi__api_8h.html#a01316099febb0ab0223aabae0a16d85b" title="Set reaction rate equation.">cSetReactionRate</a>(R3, <span class="stringliteral">&quot;k3*C*A&quot;</span>);

        <a class="code" href="copasi__api_8h.html#a94cbbd1a04cf521ec9342ffa61deb1e9" title="Add a trigger and a response, where the response is defined by a target variable and an assignment fo...">cCreateEvent</a>(model, <span class="stringliteral">&quot;event1&quot;</span>, <span class="stringliteral">&quot;time &gt; 10&quot;</span>, <span class="stringliteral">&quot;k3&quot;</span>, <span class="stringliteral">&quot;k3/2.0&quot;</span>);
        <span class="keywordflow">return</span> model;
 }
 <span class="keywordtype">int</span> main(<span class="keywordtype">int</span> nargs, <span class="keywordtype">char</span>** argv)
 {
        <a class="code" href="structtc__matrix.html" title="A 2D table of doubles with row and column names. Use tc_getMatrixValue(M,i,j) to get the i...">tc_matrix</a> efm, output, params;
        <a class="code" href="structcopasi__model.html" title="This struct is used to contain a pointer to an instance of a COPASI object.">copasi_model</a> m1, m2;

        m1 = model1();

        output = <a class="code" href="copasi__api_8h.html#a2105addec217217e5443df8d4cac8405" title="Simulate using LSODA numerical integrator.">cSimulateDeterministic</a>(m1, 0, 100, 1000);  <span class="comment">//model, start, end, num. points        </span>

        <span class="comment">//write to file</span>
        <a class="code" href="copasi__api_8h.html#a44cb74d3541273cfc7e64e7e3e0f2359" title="Save a model as an Antimony file, see antimony.sf.net for details of Antimony syntax.">cWriteAntimonyFile</a>(m1, <span class="stringliteral">&quot;model.txt&quot;</span>);
        <a class="code" href="_t_c__structs_8h.html#afd5e48e35113e4e575e6fd08da441ddf" title="Print a matrix to file.">tc_printMatrixToFile</a>(<span class="stringliteral">&quot;output.tab&quot;</span>, output);

        <span class="comment">//cleanup</span>
        <a class="code" href="_t_c__structs_8h.html#a4ced7d8d8f300f44d5deeb78d88a1c23" title="Delete a matrix.">tc_deleteMatrix</a>(output);                 
        <a class="code" href="copasi__api_8h.html#abc2d742f859eb00c34198942b22aa44c" title="remove a model">cRemoveModel</a>(m1);
        <a class="code" href="copasi__api_8h.html#afb781ad02eaef984e47c868071ebd968" title="destroy copasi -- MUST BE CALLED at the end of program">copasi_end</a>();
        <span class="keywordflow">return</span> 0;
 }
</pre></div> <h2><a class="anchor" id="install_sec"></a>
Installation</h2>
<p>The initial phase of the build process is the same for each platform, that is installing CMake and generating the appropriate build files, eg sln files for Visual Studio, make files for Linux and Mac.</p>
<p>Lets assume that the source code is located in a folder named "copasi-simple-api"</p>
<p>1) Install Cmake from cmake.org. For Linux, just type 'apt-get cmake cmake-gui'</p>
<p>2) Run cmake-gui. In the Cmake program, find two text boxes labeled, "where is the source code" and "where to build"</p>
<p>3) Type the full copasi-simple-api/ folder path for the line that says "where is the source code"</p>
<p>4) Type copasi-simple-api/BUILD folder path for the line that says "where to build"</p>
<p>5) Click the "Configure" button</p>
<p>6) Cmake will create the BUILD folder and then ask you to select the compiler. It is recommended that you use standard compilers, e.g. gcc for Unix and Visual Studio or MinGW for MS Windows.</p>
<p>7) Once configuration is done, click the "Generate" button</p>
<p>8) Go to the copasi-simple-api/BUILD folder. If you used Visual Studio as the compiler, you will find a project file (.sln) -- open it. Find the copasi_api_test, right-click on it, and set it as the startup project. If you used GCC or MinGW, "cd" into the BUILD folder and run "make copasi_api_test"</p>
<p>9) Run copasi_api_test. This is an example code using the copasi API. Now you can replace copasi_api_test with your own program. </p>
</div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Thu Oct 6 2011 14:23:51 for Copasi API by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
